include application
currentPage = "/rec"
include navBar

.content
    .row
        div.col-md-6
            .card.card-block
                .card-body
                    if(message)
                        div.alert.alert-danger(role="alert")=message
                    if(app_message)
                        div.alert.alert-primary(role="alert")=app_message
                    if(pic_local)
                        img.materialboxed(src=pic_local, width="100%")
                    table.table.table-striped
                        tbody
                            tr
                                td Сегодня распознано:
                                td=today_rec
                            tr
                                td Снимков в ожидании:
                                td=in_wait
                            tr
                                td Время распознания:
                                td.timer=0
            .card.card-block
                .card-body
                    h5.card-title="Нейросеть"
                    each item in neural
                        li.card-text=item[1]
            .card.card-block
                .card-body
                    h5.card-title="Признаки"
                    div#params
            .card.card-block
                .card-body
                    h5.card-title="Консилиум"
                    each rec in symptom_list
                        if(rec.symptom.primary)
                            p=rec.symptom.symptom_name
                    hr
                    each rec in symptom_list
                        if(rec.symptom.ismedical and rec.symptom.diagnos and not(rec.symptom.primary))
                            p(style="color:red;")=rec.symptom.symptom_name~" ("~rec.count~"%)"
                    hr
                    each rec in symptom_list
                        if(rec.symptom.ismedical and not(rec.symptom.diagnos) and not(rec.symptom.primary))
                            p(style="color:green;")=rec.symptom.symptom_name~" ("~rec.symptom.category.category_name~")"~" ("~rec.count~"%)"
                    hr
                    each rec in symptom_list
                        if not(rec.symptom.ismedical or rec.symptom.primary)
                            p(style="color:blue;")=rec.symptom.symptom_name
        div.col-md-6
            .card.card-block
                nav
                    div#tabForm.nav.nav-tabs(role="tablist")
                        a.nav-item.nav-link.active(href="#earTab", data-toggle="tab",id="ear-tab", aria-controls="earTab", aria-selected="true")="Ухо"
                        a.nav-item.nav-link(href="#throatTab", data-toggle="tab",id="throat-tab", aria-controls="throatTab", aria-selected="false")="Горло"
                        a.nav-item.nav-link(href="#noseTab", data-toggle="tab",id="nose-tab", role="tab", aria-controls="noseTab", aria-selected="false")="Нос"
                    .tab-content
                        div#earTab.tab-pane.fade.show.active(role="tabpanel", aria-labelledby="ear-tab")
                            .card-body
                                form#earform(method="post" action="#")
                                    input.hidden.timer(name = "timer", value=0, hidden)
                                    if(appointed)
                                        input.hidden(name = "appointed", value=appointed, hidden)
                                    each symp in symptoms
                                        if (symp.primary and symp.ear)
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if not(symp.ismedical or symp.primary)
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each cat in categories
                                        if(cat.id == 1)
                                            a.btn.btn-link(data-toggle="collapse", href="#nose"~cat.id, aria-expanded="true", aria-controls="#nose"~cat.id)=cat.category_name
                                        else
                                            a.btn.btn-link(data-toggle="collapse", href="#nose"~cat.id, aria-expanded="true", aria-controls="#nose"~cat.id)=cat.category_name
                                    each cat in categories
                                        if(cat.id == 1)
                                            div.collapse.show(id="nose"~cat.id)
                                                each symp in symptoms
                                                    if(symp.symptom_name and symp.ear and symp.ismedical and not(symp.diagnos) and not(symp.primary))
                                                        if(symp.cat_id == cat.id)
                                                            if(symp.id in recognized)
                                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                                            else
                                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                        else
                                            div.collapse(id="nose"~cat.id)
                                                each symp in symptoms
                                                    if(symp.symptom_name and symp.ear and symp.ismedical and not(symp.diagnos) and not(symp.primary))
                                                        if(symp.cat_id == cat.id)
                                                            if(symp.id in recognized)
                                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                                            else
                                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if(symp.symptom_name and symp.ear and symp.ismedical and symp.diagnos and not(symp.primary))
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    if(appointed)
                                        button.btn.btn-success(href="#" type="submit")="Сохранить"
                                        button.btn.btn-warning(href="/rec/skip/"~appointed)="Пропустить"
                        div#throatTab.tab-pane.fade(role="tabpanel", aria-labelledby="throat-tab")
                            .card-body
                                form#throatform(method="post" action="#")
                                    input.hidden.timer(name = "timer", value=0, hidden)
                                    if(appointed)
                                        input.hidden(name = "appointed", value=appointed, hidden)
                                    each symp in symptoms
                                        if (symp.primary and symp.throat)
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if not(symp.ismedical or symp.primary)
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if(symp.symptom_name and symp.throat and symp.ismedical and not(symp.diagnos) and not(symp.primary))
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if(symp.symptom_name and symp.throat and symp.ismedical and symp.diagnos and not(symp.primary))
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    if(appointed)
                                        button.btn.btn-success(href="#" type="submit")="Сохранить"
                                        button.btn.btn-warning(href="/rec/skip/"~appointed)="Пропустить"
                        div#noseTab.tab-pane.fade(role="tabpanel", aria-labelledby="nose-tab")
                            .card-body
                                form#noseform(method="post" action="#")
                                    input.hidden.timer(name = "timer", value=0, hidden)
                                    if(appointed)
                                        input.hidden(name = "appointed", value=appointed, hidden)
                                    each symp in symptoms
                                        if (symp.primary and symp.nose)
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if not(symp.ismedical or symp.primary)
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if(symp.symptom_name and symp.nose and symp.ismedical and not(symp.diagnos) and not(symp.primary))
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    each symp in symptoms
                                        if(symp.symptom_name and symp.nose and symp.ismedical and symp.diagnos and not(symp.primary))
                                            if(symp.id in recognized)
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name, checked)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                            else
                                                div.custom-control.custom-checkbox.my-1.mr-sm-2.checktag
                                                    input.custom-control-input.checkitem(type="checkbox", id=symp.id~'ear', name=symp.id, data-name=symp.symptom_name)
                                                    label.custom-control-label(for=symp.id~'ear')=symp.symptom_name
                                    hr
                                    if(appointed)
                                        button.btn.btn-success(href="#" type="submit")="Сохранить"